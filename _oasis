OASISFormat: 0.4
OCamlVersion: >= 4.05.0
Name:        yates
Version:     0.1
Synopsis:    Traffic engineering framework.
Authors:     YATES team
License:     LGPL-3.0
Plugins:     META (0.4), StdFiles (0.4), DevFiles (0.4)

AlphaFeatures: ocamlbuild_more_args

BuildTools: ocamlbuild

Library routing
  Path: routing
  Modules:
    Yates_Routing,
    Yates_Traffic
  BuildDepends:
   ocamlgraph,
   threads,
   ppx_jane,
   sexplib,
   frenetic

Library util
  Path: util
  CSources:
    time_stubs.c
  if system(linux)
    CCLib:
      -lrt
  Modules:
    RunningStat,
    Yates_Time
BuildDepends:
    async,
    core,
    threads

Library controller
  Path: controller
  Modules:
    Yates_Controller
  InternalModules:
    Yates_Fabric
  BuildDepends:
   async,
   frenetic,
   frenetic.async,
   ocamlgraph,
   routing,
   sexplib,
   threads,
   util

Library simulate
  Path: simulate
  Modules:
    Simulate_Switch
  BuildDepends:
    ocamlgraph,
    frenetic,
    ppx_deriving.std,
    routing,
    util

Executable yates
  Install: False
  Build$: flag(is_native)
  Path:   yates
  MainIs: Yates.ml
  CompiledObject: native
  BuildDepends:
    controller,
    routing

Executable simulator
  Install: False
  Build$: flag(is_native)
  Path:   simulate
  MainIs: Simulate_Driver.ml
  CompiledObject: native
  BuildDepends:
    ocamlgraph,
    frenetic,
    ppx_deriving.std,
    routing,
    util

Executable test_runner
 Install: false
 Build$: flag(is_native)
 Path:       test
 MainIs:     Test.ml
 CompiledObject: native
 BuildDepends:
   ppx_inline_test.runner.lib,
   routing,
   simulate,
   util

Test test
 Command: $test_runner inline-test-runner yates
 TestTools: test_runner
